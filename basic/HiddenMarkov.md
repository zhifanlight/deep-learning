<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>

# 隐马尔可夫模型

## 基本思想

- 描述有隐藏的马尔可夫链随机生成不可观测的状态序列，再由各个状态生成一个观测而产生观测序列的过程

- 隐马尔可夫模型的形式定义如下：

	- 状态集合：

		$$ Q = \\{ q\_{1}, \ q\_{2}, \ \cdots , \ q\_{N} \\} $$

	- 观测集合：

		$$ V = \\{ v\_{1}, \ v\_{2}, \ \cdots , \ v\_{M} \\} $$

	- 状态序列：

		$$ I = (i\_{1}, \ i\_{2}, \ \cdots , \ i\_{T}) $$

	- 观测序列：

		$$ O = (o\_{1}, \ o\_{2}, \ \cdots , \ o\_{T}) $$

	- 状态转移矩阵：

		$$ A = \left[ \ a\_{ij} \ \right]\_{N \times N} $$

		- 其中 \\(a\_{ij}\\) 表示由状态 \\(q\_{i}\\) 转移到状态 \\(q\_{j}\\) 的概率：

			$$ a\_{ij} = P(i\_{t+1}=q\_{j} \ | \ i\_{t}=q\_{i}) $$

	- 观测概率矩阵：

		$$ B = \left[ \ b\_{j}(k) \ \right]\_{N \times M} $$

		- 其中 \\(b\_{j}(k)\\) 表示状态 \\(q\_{j}\\) 下观测到 \\(v\_{k}\\) 的概率：

			$$ b\_{j}(k) = P(o\_{t}=v\_{k} \ | \ i\_{t}=q\_{j}) $$

	- 初始状态概率向量：

		$$ \pi = (\pi\_{i}) $$

		- 其中 \\(\pi\_{i}\\) 是初始时刻处于状态 \\(q\_{i}\\) 的概率：

			$$ \pi\_{i} = P(i\_{1}=q\_{i}) $$

- 隐马尔可夫模型三要素：

	- 状态转移概率矩阵 \\(A\\)

	- 观测概率矩阵 \\(B\\)

	- 初始状态概率向量 \\(\pi\\)

- 隐马尔可夫模型两个基本假设：

	- 任意时刻的状态只依赖于前一时刻的状态

	- 任意时刻的观测只依赖于该时刻的状态

- 隐马尔可夫模型三个基本问题：

	- 估值问题：

		- 给定模型和观测序列，计算观测序列出现的概率

	- 学习问题：

		- 给定观测序列，估计模型参数

	- 解码问题：

		- 给定模型和观测序列，求最有可能的状态序列

## 估值问题

### 前向算法

- 给定模型和观测序列，计算观测序列出现的概率

- 定义前向概率为 \\(t\\) 时刻状态为 \\(q\_{i}\\)、观测序列为 \\(o\_{1}, \ o\_{2}, \ \cdots , \ o\_{t}\\) 的概率：

	$$ \alpha\_{t}(i) = P(o\_{1}, o\_{2}, \cdots , o\_{t}, \ i\_{t}=q\_{i}) $$

- 初始化：

	$$ \alpha\_{1}(i) = \pi\_{i} b\_{i}(o\_{1}) $$

- 递推式：

	$$ \alpha\_{t+1}(i) = \left[ \sum\_{j=1}^{N} \alpha\_{t}(j) \cdot a\_{ji} \right] \cdot b\_{i}(o\_{t+1}) $$

- 终止：

	$$ P(O | \lambda) = \sum\_{i=1}^{N} \alpha\_{T}(i) $$

- 时间复杂度为 \\(O(N^{2}T)\\)：

	- 需要计算 \\(T\\) 个时刻的概率

	- 每个时刻计算 \\(N\\) 个概率

	- 每次计算需要前一时刻 \\(N\\) 个状态的概率

### 后向算法	

- 给定模型和观测序列，计算观测序列出现的概率

- 定义后向概率为 \\(t\\) 时刻状态为 \\(q\_{i}\\) 的条件下、 从 \\(t+1\\) 到 \\(T\\) 时刻观测序列为 \\(o\_{t+1}, \ o\_{t+2}, \ \cdots , \ o\_{T}\\) 的概率：

	$$ \beta\_{t}(i) = P(o\_{t+1}, o\_{t+2}, \cdots , o\_{T} \ | \ i\_{t}=q\_{i} )$$

- 初始化：

	$$ \beta\_{T}(i) = 1 $$

- 递推式：

	$$ \beta\_{t}(i) = \sum\_{j=1}^{N} \beta\_{t+1}(j) \cdot a\_{ij} \cdot b\_{j}(o\_{t+1}) $$

- 终止：

	$$ P(O | \lambda) = \sum\_{i=1}^{N} \beta\_{1}(i) \cdot \pi\_{i} \cdot b\_{i}(o\_{1}) $$

- 时间复杂度为 \\(O(N^{2}T)\\)：

	- 需要计算 \\(T\\) 个时刻的概率

	- 每个时刻计算 \\(N\\) 个概率

	- 每次计算需要后一时刻 \\(N\\) 个状态的概率


## 解码问题

### 维特比算法

- 给定模型和观测序列，求最有可能的状态序列

- 在 \\(t\\) 时刻状态为 \\(i\\) 的所有路径 \\(i\_{1}, \ i\_{2}, \ \cdots , \ i\_{t}\\) 中概率最大值为：

	$$ \delta\_{t}(i) = \max P(i\_{t}=i, \ i\_{t-1}, \cdots , i\_{1}, \ o\_{t}, \cdots , o\_{1}) $$

	- 产生当前最大概率值的结点为 \\(j\\)

- 初始化：

	$$ \delta\_{1}(i) = \pi\_{i} b\_{1}(i) $$

	$$ \Phi\_{1}(i) = 0 $$

- 递推式：

	$$ \delta\_{t}(i) = \max \left[ \delta\_{t-1}(j) \cdot a\_{ji} \right] \cdot b\_{i}(o\_{t}) $$

	$$ \Phi\_{t}(i) = \arg \max\_{j} \left[ \delta\_{t-1}(j) \cdot a\_{ji} \right] $$

- 终止：

	$$ P^{\*} = \max \delta\_{T}(i) $$

	$$ i\_{T}^{\*} = \arg \max\_{i} \delta\_{T}(i) $$

- 回溯：

	$$ i\_{t}^{\*} = \Phi\_{t+1}(i\_{t+1}^{\*}) $$